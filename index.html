<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>LK-Game</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: #0E2216;
      font-family: sans-serif;
    }
    canvas {
      display: block;
      margin: auto;
      background: url(1.jpg);
      border: 2px solid #0f0;
      touch-action: none;
      width: 100%;
      height: 100vh;
      padding-bottom: 50px;
    }
    #gameOverModal {
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      background: rgba(0, 0, 0, 0.8);
      flex-direction: column;
      z-index: 10;
      color: white;
      font-size: 24px;
      display: none;
      pointer-events: none; /* –ë–ª–æ–∫—É—î–º–æ –≤–∑–∞—î–º–æ–¥—ñ—é –∑ –º–æ–¥–∞–ª—å–Ω–∏–º –≤—ñ–∫–Ω–æ–º */
    }
    .btn {
      margin-top: 20px;
      padding: 10px 20px;
      background: #0f0;
      border: none;
      border-radius: 10px;
      font-size: 18px;
      cursor: pointer;
    }
    .btn.exit {
      background: #f00;
      margin-left: 10px;
    }
    #paddle {
      position: absolute;
      bottom: 50px;
      left: 50%;
      width: 100px;
      height: 20px;
      background: red;
      background-size: cover;
      background-position: center;
      transform: translateX(-50%);
    }
  </style>
</head>
<body>
<canvas id="gameCanvas"></canvas>
<div id="gameOverModal">
  <div>üò¢ –ì—Ä—É –∑–∞–∫—ñ–Ω—á–µ–Ω–æ!</div>
  <div>
    <button class="btn" onclick="restartGame()">üîÅ –©–µ —Ä–∞–∑</button>
    <button class="btn exit" onclick="exitGame()">üö™ –í–∏–π—Ç–∏</button>
  </div>
</div>
<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
const modal = document.getElementById("gameOverModal");

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resizeCanvas();
window.addEventListener('resize', resizeCanvas);

let ballRadius = canvas.width * 0.01;
let x = canvas.width / 2;
let y = canvas.height - 80;
let dx = canvas.width * 0.005;
let dy = -canvas.height * 0.007;

let paddleHeight = canvas.height * 0.02;
let paddleWidth = canvas.width * 0.2;
let paddleX = (canvas.width - paddleWidth) / 2;

let brickRowCount = 5;
let brickColumnCount = 10;
let brickWidth = canvas.width * 0.08;
let brickHeight = canvas.height * 0.04;
let brickPadding = canvas.width * 0.01;
let brickOffsetTop = canvas.height * 0.1;
let brickOffsetLeft = canvas.width * 0.05;

let score = 0;
let gameOver = false;

const bricks = [];
for (let c = 0; c < brickColumnCount; c++) {
  bricks[c] = [];
  for (let r = 0; r < brickRowCount; r++) {
    bricks[c][r] = { x: 0, y: 0, status: 1, hits: Math.floor(Math.random() * 10) + 1 };
  }
}

document.addEventListener("mousemove", mouseMoveHandler, false);
document.addEventListener("touchmove", touchMoveHandler, false);

function mouseMoveHandler(e) {
  let mouseX = e.clientX;
  paddleX = mouseX - paddleWidth / 2;
  if (paddleX < 0) paddleX = 0;
  else if (paddleX + paddleWidth > canvas.width) paddleX = canvas.width - paddleWidth;
}

function touchMoveHandler(e) {
  let touchX = e.touches[0].clientX;
  paddleX = touchX - paddleWidth / 2;
  if (paddleX < 0) paddleX = 0;
  else if (paddleX + paddleWidth > canvas.width) paddleX = canvas.width - paddleWidth;
}

function collisionDetection() {
  for (let c = 0; c < brickColumnCount; c++) {
    for (let r = 0; r < brickRowCount; r++) {
      let b = bricks[c][r];
      if (b.status === 1) {
        if (x > b.x && x < b.x + brickWidth && y > b.y && y < b.y + brickHeight) {
          dy = -dy;
          if (b.hits > 0) {
            b.hits--;
            score++;
          }
          if (b.hits <= 0) {
            b.status = 0;
          }
        }
      }
    }
  }
}

let paddleImage = new Image();
paddleImage.src = "logo.png";

function drawBall() {
  ctx.beginPath();
  ctx.arc(x, y, ballRadius, 0, Math.PI * 2);
  ctx.fillStyle = "#0f0";
  ctx.fill();
  ctx.closePath();
}

function drawPaddle() {
  ctx.beginPath();
  ctx.drawImage(paddleImage, paddleX, canvas.height - paddleHeight - 50, paddleWidth, paddleHeight);
  ctx.closePath();
}

function drawBricks() {
  for (let c = 0; c < brickColumnCount; c++) {
    for (let r = 0; r < brickRowCount; r++) {
      if (bricks[c][r].status === 1) {
        let brickX = c * (brickWidth + brickPadding) + brickOffsetLeft;
        let brickY = r * (brickHeight + brickPadding) + brickOffsetTop;
        bricks[c][r].x = brickX;
        bricks[c][r].y = brickY;
        ctx.font = "30px Arial";
        ctx.fillText("üì¶", brickX + brickWidth / 2 - 15, brickY + brickHeight / 2 + 10);
        ctx.font = "16px Arial";
        ctx.fillStyle = "#0E2216";
        ctx.fillText(bricks[c][r].hits, brickX + brickWidth / 2 - 8, brickY + brickHeight / 2 + 5);
      }
    }
  }
}

function drawScore() {
  ctx.font = "16px Arial";
  ctx.fillStyle = "#0f0";
  ctx.fillText("–û—á–∫–∏: " + score, 8, 20);
}

function draw() {
  if (gameOver) return;
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawBricks();
  drawBall();
  drawPaddle();
  drawScore();
  collisionDetection();

  if (x + dx > canvas.width - ballRadius || x + dx < ballRadius) {
    dx = -dx;
  }
  if (y + dy < ballRadius) {
    dy = -dy;
  } else if (y + dy > canvas.height - paddleHeight - 50) { // –í—Ä–∞—Ö–æ–≤—É—î–º–æ –≤—ñ–¥—Å—Ç—É–ø –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏
    if (x > paddleX && x < paddleX + paddleWidth) {
      // –Ø–∫—â–æ –º'—è—á –ø–æ—Ç—Ä–∞–ø–ª—è—î –≤ –º–µ–∂—ñ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏
      let relativeX = x - (paddleX + paddleWidth / 2);
      let normalizedRelativeX = relativeX / (paddleWidth / 2); // –ù–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è –¥–ª—è –≤—ñ–¥–±–∏—Ç—Ç—è
      dx = normalizedRelativeX * 2; // –ú–æ–¥–∏—Ñ—ñ–∫—É—î–º–æ —à–≤–∏–¥–∫—ñ—Å—Ç—å –≤—ñ–¥–±–∏–≤–∞–Ω–Ω—è –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—ñ
      dy = -dy;
    } else {
      showGameOver("üò¢ –ì—Ä—É –∑–∞–∫—ñ–Ω—á–µ–Ω–æ!");
    }
  }

  x += dx;
  y += dy;
  requestAnimationFrame(draw);
}
draw();

function showGameOver(message) {
  gameOver = true;
  modal.style.display = "flex";
  modal.querySelector("div").textContent = message;
  
  // –í–º–∏–∫–∞—î–º–æ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ –º–æ–¥–∞–ª—å–Ω–∏–º –≤—ñ–∫–Ω–æ–º
  modal.style.pointerEvents = "auto"; // –î–æ–∑–≤–æ–ª—è—î–º–æ –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏ –∑ –º–æ–¥–∞–ª—å–Ω–∏–º –≤—ñ–∫–Ω–æ–º
}

function restartGame() {
  modal.style.pointerEvents = "none"; // –ó–∞–±–æ—Ä–æ–Ω—è—î–º–æ –≤–∑–∞—î–º–æ–¥—ñ—é –∑ –º–æ–¥–∞–ª—å–Ω–∏–º –≤—ñ–∫–Ω–æ–º –ø—ñ—Å–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫—É
  document.location.reload();
}

function exitGame() {
  modal.style.pointerEvents = "none"; // –ó–∞–±–æ—Ä–æ–Ω—è—î–º–æ –≤–∑–∞—î–º–æ–¥—ñ—é –∑ –º–æ–¥–∞–ª—å–Ω–∏–º –≤—ñ–∫–Ω–æ–º –ø—ñ—Å–ª—è –≤–∏—Ö–æ–¥—É
  window.location.href = "https://t.me/LK_Trans_BOT";
}

// –î–æ–¥–∞–Ω–æ –¥–ª—è –±–ª–æ–∫—É–≤–∞–Ω–Ω—è —Å–≤–∞–π–ø—ñ–≤
modal.addEventListener('touchstart', function(e) {
  e.preventDefault();
}, { passive: false });

modal.addEventListener('touchmove', function(e) {
  e.preventDefault();
}, { passive: false });

modal.addEventListener('touchend', function(e) {
  e.preventDefault();
}, { passive: false });
</script>
</body>
</html>
